---
layout: default
---
<h1>{{ page.title }}</h1>

{% if page.collection and page.collection.size > 0 %}
  {% assign books = site[page.collection] | sort: "finished" | reverse %}
  {% if books and books.size > 0 %}
    {% assign current_year = nil %}
    {% for book in books %}
      {% assign book_year = book.finished | date: "%Y" %}
      {% if book_year != current_year %}
        {% unless forloop.first %}
          </div> <!-- close previous year-group -->
        {% endunless %}
        <h2 id="y{{ book_year }}">{{ book_year }}</h2>
        <div class="bookshelf-year">
        {% assign current_year = book_year %}
      {% endif %}

      <div class="book-card mb-4 d-flex">
        <!-- LEFT: cover -->
        <div class="book-cover mr-4">
          {% if book.cover %}
            <img
              src="{{ book.cover | prepend: page.covers | relative_url }}"
              alt="{{ book.title }} cover"
              style="max-height:200px; width:auto; border-radius:4px;"
            >
          {% endif %}
        </div>

        <!-- RIGHT: metadata -->
        <div class="book-info flex-fill">
          <h3 class="mb-1">{{ book.title }}</h3>
          {% if book.author %}
            <p class="text-muted mb-2">{{ book.author }}</p>
          {% endif %}

        <!-- Star rating with inline Goodreads icon -->
		<div class="rating mb-2 d-inline-flex align-items-center">
			{% assign stars = book.rating | default: 0 %}
			{% for i in (1..5) %}
			{% if i <= stars %}
				<i class="fas fa-star"></i>
			{% else %}
				<i class="far fa-star"></i>
			{% endif %}
			{% endfor %}

			{% if book.goodreads_url %}
			<a href="{{ book.goodreads_url }}"
				target="_blank"
				rel="noopener"
				class="goodreads-icon"
				aria-label="Goodreads review">
				<i class="fab fa-goodreads fa-lg"></i>
			</a>
			{% endif %}
		</div>

          <!-- Collapsible review text -->
          {% if book.review %}
            <details class="mt-2">
              <summary>Review</summary>
              <div class="review-text mt-1">
                {{ book.review | | xml_escape | newline_to_br }}
              </div>
            </details>
          {% endif %}
        </div>
      </div>

      {% if forloop.last %}
        </div> <!-- close last year-group -->
      {% endif %}
    {% endfor %}
  {% endif %}
{% endif %}
